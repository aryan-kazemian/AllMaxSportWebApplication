/*! For license information please see 232.84c48ca2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkallmaxsport=self.webpackChunkallmaxsport||[]).push([[232],{2054:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3232:(e,s,t)=>{t.r(s),t.d(s,{default:()=>z});var a=t(5043),l=t(6662),n=t(7819),d=t(5088),r=t(2054),c=t(7784);const i=(0,c.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var o=t(5692),x=t(2983),m=t(5244),h=t(9350),g=t(614),u=t(4459);const p=(0,c.A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var y=t(4806),v=t(3546),b=t(5746),j=t(579);const w=e=>{let{newMessage:s,setNewMessage:t,handleSendMessage:a}=e;return(0,j.jsx)("div",{className:"mt-4",children:(0,j.jsxs)("div",{className:"flex",children:[(0,j.jsx)("input",{type:"text",value:s,onChange:e=>t(e.target.value),onKeyDown:e=>"Enter"===e.key&&a(e),placeholder:"\u067e\u06cc\u0627\u0645 \u062e\u0648\u062f \u0631\u0627 \u0628\u0646\u0648\u06cc\u0633\u06cc\u062f...",className:"flex-1 p-3 border border-gray-300 rounded-r-lg focus:outline-none"}),(0,j.jsx)("button",{onClick:a,className:"bg-blue-500 text-white rounded-l-lg p-3 hover:bg-blue-600",children:(0,j.jsx)(b.A,{className:"w-5 h-5"})})]})})},N=e=>{let{message:s,customerName:t}=e;return(0,j.jsxs)(y.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-lg "+("admin"===s.sender?"bg-blue-200 ml-4":"bg-gray-50 mr-4"),children:[(0,j.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,j.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"admin"===s.sender?"\u067e\u0634\u062a\u06cc\u0628\u0627\u0646\u06cc":t}),(0,j.jsx)("p",{className:"text-xs text-gray-500",children:new Date(s.timestamp).toLocaleTimeString("fa-IR")})]}),(0,j.jsx)("p",{className:"text-gray-700",children:s.message})]})},f=e=>{let{ticket:s,handleStatusChange:t}=e;return(0,j.jsxs)("div",{children:[(0,j.jsx)("h3",{className:"text-lg font-semibold text-gray-100 mb-4",children:"\u062c\u0632\u0626\u06cc\u0627\u062a \u062a\u06cc\u06a9\u062a"}),(0,j.jsxs)("div",{className:"space-y-4",children:[(0,j.jsxs)("div",{className:"bg-zinc-700 py-4 px-6 rounded-lg",children:[(0,j.jsx)("p",{className:"text-sm text-gray-100",children:"\u06a9\u0627\u0631\u0628\u0631 : "}),(0,j.jsx)("p",{className:"text-white",children:null===s||void 0===s?void 0:s.customer_name})]}),(0,j.jsxs)("div",{className:"bg-zinc-700 py-4 px-6 rounded-lg",children:[(0,j.jsx)("p",{className:"text-sm text-gray-100",children:"\u0645\u0648\u0636\u0648\u0639"}),(0,j.jsx)("p",{className:"text-white",children:s.subject})]}),(0,j.jsxs)("div",{className:"bg-zinc-700 py-4 px-6 rounded-lg",children:[(0,j.jsx)("p",{className:"text-sm text-gray-100",children:"\u0648\u0636\u0639\u06cc\u062a"}),(0,j.jsx)("div",{className:"relative",children:(0,j.jsxs)("select",{value:s.status,onChange:e=>t(e.target.value),className:"appearance-none w-full p-2 border border-gray-300 rounded-lg bg-zinc-700 text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition duration-150 ease-in-out pr-8",children:[(0,j.jsx)("option",{value:"pending",className:"bg-zinc-700 text-gray-100",children:"\u062f\u0631 \u0627\u0646\u062a\u0638\u0627\u0631"}),(0,j.jsx)("option",{value:"open",className:"bg-zinc-700 text-gray-100",children:"\u0628\u0627\u0632"}),(0,j.jsx)("option",{value:"closed",className:"bg-zinc-700 text-gray-100",children:"\u0628\u0633\u062a\u0647"})]})})]}),(0,j.jsxs)("div",{className:"bg-zinc-700 py-4 px-6 rounded-lg",children:[(0,j.jsx)("p",{className:"text-sm text-gray-100",children:"\u0627\u06cc\u062c\u0627\u062f \u0634\u062f\u0647"}),(0,j.jsx)("p",{className:"text-white",children:new Date(s.created_at).toLocaleString("fa-IR")})]}),(0,j.jsxs)("div",{className:"bg-zinc-700 py-4 px-6 rounded-lg",children:[(0,j.jsx)("p",{className:"text-sm text-gray-100",children:"\u0622\u062e\u0631\u06cc\u0646 \u0628\u0647\u200c\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06cc"}),(0,j.jsx)("p",{className:"text-white",children:new Date(s.updated_at).toLocaleString("fa-IR")})]})]})]})},k={open:{bg:"bg-blue-100",text:"text-blue-800",icon:n.A},pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:d.A},resolved:{bg:"bg-green-100",text:"text-green-800",icon:r.A},closed:{bg:"bg-gray-100",text:"text-gray-800",icon:i}},z=()=>{var e,s,t;const{ticketId:r}=(0,l.g)(),c=(0,l.Zp)(),[i,b]=(0,a.useState)(null),[z,A]=(0,a.useState)(""),[S,C]=(0,a.useState)(!0),[M,D]=(0,a.useState)([]),[E,I]=(0,a.useState)(!1),[$,L]=(0,a.useState)(!1),_=(0,a.useRef)(null),O="localhost"===window.location.hostname?"http://127.0.0.1:8000/api/tickets/":"https://allmaxsport.com/api/tickets/";(0,a.useEffect)((()=>{!async function(){const e=await fetch(`${O}?id=${r}`),s=await e.json();b(s[0]),D(s[0].messages),C(!1)}();const e=()=>{const e=window.scrollY;I(e>100)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[r]),(0,a.useEffect)((()=>{T()}),[M]);const T=()=>{var e;null===(e=_.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},H=e=>{b((s=>({...s,status:e,lastUpdated:(new Date).toISOString()}))),fetch(`${O}?id=${i.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e,updated_at:(new Date).toISOString()})}).then((e=>e.ok?e.json():e.text().then((e=>{throw new Error(e)})))).then((e=>console.log("Status updated successfully:",e))).catch((e=>console.error("Error updating status:",e)))};if(S)return(0,j.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,j.jsxs)("div",{className:"text-center",children:[(0,j.jsx)("div",{className:"w-16 h-16 border-4 border-t-blue-500 border-blue-200 rounded-full animate-spin mx-auto mb-4"}),(0,j.jsx)("p",{className:"text-gray-400",children:"\u062f\u0631 \u062d\u0627\u0644 \u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062a\u06cc\u06a9\u062a..."})]})});const R=(null===(e=k[i.status])||void 0===e?void 0:e.icon)||n.A;return(0,j.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-zinc-900 relative",children:[(0,j.jsx)("header",{className:`sticky top-0 z-20 transition-all duration-300 ${E?"bg-white dark:bg-zinc-800 shadow-md":"bg-transparent"} py-3 px-4`,children:(0,j.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsxs)(y.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>c("/dashboard/tickets"),className:"flex items-center mr-3 text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400",children:[(0,j.jsx)(o.A,{className:"w-5 h-5"}),(0,j.jsx)("span",{className:"hidden md:inline mr-1",children:"\u0628\u0627\u0632\u06af\u0634\u062a"})]}),(0,j.jsx)("button",{onClick:()=>L(!$),className:"md:hidden mr-2 text-gray-600 dark:text-gray-300",children:(0,j.jsx)(x.A,{className:"w-5 h-5"})}),(0,j.jsxs)("h1",{className:"text-lg md:text-xl font-bold text-gray-800 dark:text-gray-100 flex items-center",children:[(0,j.jsx)(m.A,{className:"w-5 h-5 md:w-6 md:h-6 ml-1 text-blue-500"}),(0,j.jsxs)("span",{className:"truncate max-w-[150px] md:max-w-full",children:["\u062a\u06cc\u06a9\u062a #",i.id]})]})]}),(0,j.jsxs)("div",{className:"flex items-center space-x-2 space-x-reverse",children:[(0,j.jsxs)("div",{className:`${(null===(s=k[i.status])||void 0===s?void 0:s.bg)||"bg-gray-100"} ${(null===(t=k[i.status])||void 0===t?void 0:t.text)||"text-gray-800"} px-2 py-1 rounded-full text-xs md:text-sm font-medium flex items-center`,children:[(0,j.jsx)(R,{className:"w-3 h-3 md:w-4 md:h-4 ml-1"}),"open"===i.status?"\u0628\u0627\u0632":"pending"===i.status?"\u062f\u0631 \u0627\u0646\u062a\u0638\u0627\u0631":"resolved"===i.status?"\u062d\u0644 \u0634\u062f\u0647":"\u0628\u0633\u062a\u0647 \u0634\u062f\u0647"]}),(0,j.jsxs)("div",{className:"hidden sm:flex px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs md:text-sm font-medium items-center",children:[(0,j.jsx)(h.A,{className:"w-3 h-3 md:w-4 md:h-4 ml-1"}),i.priority]})]})]})}),(0,j.jsx)("div",{className:"fixed inset-0 bg-zinc bg-opacity-50 z-30 md:hidden transition-opacity duration-300 "+($?"opacity-100":"opacity-0 pointer-events-none"),onClick:()=>L(!1)}),(0,j.jsxs)("div",{className:"fixed top-0 right-0 h-full w-3/4 max-w-xs bg-zinc dark:bg-zinc-800 shadow-xl z-40 md:hidden transform transition-transform duration-300 "+($?"translate-x-0":"translate-x-full"),children:[(0,j.jsxs)("div",{className:"p-4 flex justify-between items-center border-b border-zinc-200 dark:border-zinc-700",children:[(0,j.jsx)("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100",children:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062a\u06cc\u06a9\u062a"}),(0,j.jsx)("button",{onClick:()=>L(!1),className:"text-gray-500",children:(0,j.jsx)(g.A,{className:"w-5 h-5"})})]}),(0,j.jsx)("div",{className:"p-4 overflow-y-auto",children:(0,j.jsx)(f,{ticket:i,handleStatusChange:H})})]}),(0,j.jsxs)("main",{className:"p-3 md:p-6 max-w-7xl mx-auto",children:[(0,j.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm mb-4 overflow-hidden",children:(0,j.jsxs)("div",{className:"bg-zinc-50 dark:bg-zinc-900/30 p-3 md:p-4 border-b border-zinc-100 dark:bg-zinc-800",children:[(0,j.jsx)("h2",{className:"text-md md:text-lg font-semibold text-gray-800 dark:text-gray-100 line-clamp-2",children:null===i||void 0===i?void 0:i.subject}),(0,j.jsxs)("div",{className:"flex flex-wrap items-center text-xs md:text-sm text-gray-500 dark:text-gray-400 mt-2 gap-y-2 gap-x-3",children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)(u.A,{className:"w-3 h-3 md:w-4 md:h-4 ml-1"}),null===i||void 0===i?void 0:i.customer_name]}),(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)(p,{className:"w-3 h-3 md:w-4 md:h-4 ml-1"}),null===M||void 0===M?void 0:M.length," \u067e\u06cc\u0627\u0645"]}),(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)(d.A,{className:"w-3 h-3 md:w-4 md:h-4 ml-1"}),new Date(i.created_at).toLocaleDateString("fa-IR")]})]})]})}),(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[(0,j.jsx)("div",{className:"hidden md:block",children:(0,j.jsx)("div",{className:"bg-white dark:bg-zinc-800 rounded-lg shadow-sm p-4 md:p-6",children:(0,j.jsx)(f,{ticket:i,handleStatusChange:H})})}),(0,j.jsxs)("div",{className:"md:col-span-2 flex flex-col bg-white dark:bg-zinc-800 rounded-lg shadow-sm overflow-hidden h-[calc(100vh-240px)] md:h-[700px]",children:[(0,j.jsxs)("div",{className:"flex-grow overflow-y-auto p-3 md:p-4 space-y-4",children:[(0,j.jsx)(v.N,{mode:"wait",children:null===M||void 0===M?void 0:M.map((e=>(0,j.jsx)(N,{message:e,customerName:i.customer_name},e.id)))}),(0,j.jsx)("div",{ref:_})]}),(0,j.jsx)("div",{className:"border-t border-gray-200 dark:border-zinc-700 p-3 md:p-4",children:(0,j.jsx)(w,{newMessage:z,setNewMessage:A,handleSendMessage:e=>{if(e.preventDefault(),null!==z&&void 0!==z&&z.trim()){const e={id:(null===M||void 0===M?void 0:M.length)+1,ticket:r,text:z,sender:"admin",message:z,timestamp:(new Date).toISOString(),isUser:!1};D((s=>[...s,e])),A(""),fetch(`${O}?id=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.ok?e.json():e.text().then((e=>{throw new Error(e)})))).then((e=>console.log("new message Data: ",e))).catch((e=>console.error("Error:",e)))}}})})]})]})]})]})}},4459:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5088:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5244:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},5746:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},7819:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},9350:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(7784).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])}}]);
//# sourceMappingURL=232.84c48ca2.chunk.js.map